%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Structured General Purpose Assignment
% LaTeX Template
%
% This template has been downloaded from:
% http://www.latextemplates.com
%
% Original author:
% Ted Pavlic (http://www.tedpavlic.com)
%
% Note:
% The \lipsum[#] commands throughout this template generate dummy text
% to fill the template out. These commands should all be removed when 
% writing assignment content.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass{article}

\usepackage{fancyhdr} % Required for custom headers
\usepackage{lastpage} % Required to determine the last page for the footer
\usepackage{extramarks} % Required for headers and footers
\usepackage{graphicx} % Required to insert images
\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template
\usepackage{listings}
\usepackage{color}
\usepackage{amsmath}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true
  tabsize=3
}

% Margins
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in 

\linespread{1.1} % Line spacing

% Set up the header and footer
\pagestyle{fancy}
\lhead{\hmwkAuthorName} % Top left header
\chead{\hmwkClass\ (\hmwkClassInstructor\ \hmwkClassTime): \hmwkTitle} % Top center header
\rhead{\firstxmark} % Top right header
\lfoot{\lastxmark} % Bottom left footer
\cfoot{} % Bottom center footer
\rfoot{Page\ \thepage\ of\ \pageref{LastPage}} % Bottom right footer
\renewcommand\headrulewidth{0.4pt} % Size of the header rule
\renewcommand\footrulewidth{0.4pt} % Size of the footer rule

\setlength\parindent{0pt} % Removes all indentation from paragraphs

%----------------------------------------------------------------------------------------
%	DOCUMENT STRUCTURE COMMANDS
%	Skip this unless you know what you're doing
%----------------------------------------------------------------------------------------

% Header and footer for when a page split occurs within a problem environment
\newcommand{\enterProblemHeader}[1]{
\nobreak\extramarks{#1}{#1 continued on next page\ldots}\nobreak
\nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
}

% Header and footer for when a page split occurs between problem environments
\newcommand{\exitProblemHeader}[1]{
\nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
\nobreak\extramarks{#1}{}\nobreak
}

\setcounter{secnumdepth}{0} % Removes default section numbers
\newcounter{homeworkProblemCounter} % Creates a counter to keep track of the number of problems

\newcommand{\homeworkProblemName}{}
\newenvironment{homeworkProblem}[1][Problem \arabic{homeworkProblemCounter}]{ % Makes a new environment called homeworkProblem which takes 1 argument (custom name) but the default is "Problem #"
\stepcounter{homeworkProblemCounter} % Increase counter for number of problems
\renewcommand{\homeworkProblemName}{#1} % Assign \homeworkProblemName the name of the problem
\section{\homeworkProblemName} % Make a section in the document with the custom problem count
\enterProblemHeader{\homeworkProblemName} % Header and footer within the environment
}{
\exitProblemHeader{\homeworkProblemName} % Header and footer after the environment
}

\newcommand{\problemAnswer}[1]{ % Defines the problem answer command with the content as the only argument
\noindent\framebox[\columnwidth][c]{\begin{minipage}{0.98\columnwidth}#1\end{minipage}} % Makes the box around the problem answer and puts the content inside
}

\newcommand{\homeworkSectionName}{}
\newenvironment{homeworkSection}[1]{ % New environment for sections within homework problems, takes 1 argument - the name of the section
\renewcommand{\homeworkSectionName}{#1} % Assign \homeworkSectionName to the name of the section from the environment argument
\subsection{\homeworkSectionName} % Make a subsection with the custom name of the subsection
\enterProblemHeader{\homeworkProblemName\ [\homeworkSectionName]} % Header and footer within the environment
}{
\enterProblemHeader{\homeworkProblemName} % Header and footer after the environment
}
   
%----------------------------------------------------------------------------------------
%	NAME AND CLASS SECTION
%----------------------------------------------------------------------------------------

\newcommand{\hmwkTitle}{Homework 1} % Assignment title
\newcommand{\hmwkDueDate}{Aug 14,\ 2014} % Due date
\newcommand{\hmwkClass}{Numerical Linear Algebra} % Course/class
\newcommand{\hmwkClassTime}{6:00 pm} % Class/lecture time
\newcommand{\hmwkClassInstructor}{Lecture time:} % Teacher/lecturer
\newcommand{\hmwkAuthorName}{Weiyi Chen} % Your name

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title{
\vspace{2in}
\textmd{\textbf{\hmwkClass:\ \hmwkTitle}}\\
\normalsize\vspace{0.1in}\small{Due\ on\ \hmwkDueDate}\\
\vspace{0.1in}\large{\textit{\hmwkClassInstructor\ \hmwkClassTime}}
\vspace{3in}
}

\author{\textbf{\hmwkAuthorName}}
\date{} % Insert date here if you want it to appear below your name

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle

%----------------------------------------------------------------------------------------
%	TABLE OF CONTENTS
%----------------------------------------------------------------------------------------

%\setcounter{tocdepth}{1} % Uncomment this line if you don't want subsections listed in the ToC

%\newpage
%\tableofcontents
\newpage

%----------------------------------------------------------------------------------------
%   PROBLEM 1
%----------------------------------------------------------------------------------------

\begin{homeworkProblem}
    Find the correlation matrix of these random variables.
    \begin{homeworkSection}{Answer}
        The correlation matrix is
        \begin{equation}
            \Omega_X = D_{\sigma_X}^{-1} \Sigma_X D_{\sigma_X}^{-1} = \left(
            \begin{array} {ccc}
                1 & -0.35 & 0.15 \\
                -0.35 & 1 & 0.05 \\
                0.15 & 0.05 & 1   
            \end{array}
            \right)
        \end{equation}
        where
        \begin{equation}
            D_{\sigma_X} = diag(\sqrt{\Sigma_X(i,i)})_{i=1:n} = \left( 
            \begin{array} {ccc}
                1 & 0 & 0 \\
                0 & 1.5 & 0 \\
                0 & 0 & 2.5
            \end{array}
            \right)
        \end{equation}
    \end{homeworkSection}
\end{homeworkProblem}

%----------------------------------------------------------------------------------------
%   PROBLEM 2
%----------------------------------------------------------------------------------------

\begin{homeworkProblem}
    The file indeces-jul26-aug9-2012.xlsx from fepress.org/nla-primer contains the July 26, 2012 â€“ August 9, 2012 end of day values of Dow Jones, Nasdaq, and S\&P 500...
    \begin{homeworkSection}{(i)}
        The daily percentage returns $X$ is:
\begin{table}[h]
\centering
\begin{tabular}{rrrr}
 & Dow Jones & NASDAQ & S\&P 500 \\
0 & 0.014566342 & 0.022410784 & 0.019080602 \\
1 & -0.000202667 & -0.004141186 & -0.000483416 \\
2 & -0.004920825 & -0.002145398 & -0.004316754 \\
3 & -0.002502175 & -0.0065691 & -0.00289998 \\
4 & -0.00749453 & -0.003575085 & -0.007503708 \\
5 & 0.016871809 & 0.019977524 & 0.019040293 \\
6 & 0.001629484 & 0.007416018 & 0.002329276 \\
7 & 0.003894794 & 0.008679191 & 0.005106761 \\
8 & 0.000534605 & -0.001528586 & 0.00062083 \\
9 & -0.00079313 & 0.00245413 & 0.00041363
\end{tabular}
\end{table}
    \end{homeworkSection}
    \begin{homeworkSection}{(ii)}
        The covariance matrix is computed by
        \begin{equation}
            \hat \Sigma_X = \frac{1}{N-1} \overline T_X^t \overline T_X
        \end{equation}
        where $\overline T_X^t (i,k) = X_k(t_i) - \hat \mu_k$. The result is:
\begin{table}[h]
\centering
\begin{tabular}{rrrr}
          & Dow Jones  & NASDAQ      & S\&P 500   \\
Dow Jones & 6.1742e-05 & 7.4276e-05  & 7.1106e-05 \\
NASDAQ    & 7.4276e-05 & 0.000103667 & 8.7988e-05 \\
S\&P 500  & 7.1106e-05 & 8.7988e-05  & 8.2637e-05
\end{tabular}
\end{table}
        \\Python code attached:
        \begin{lstlisting}
import numpy as np 
import pandas as pd
from numpy.linalg import inv

#1
df_price = pd.read_csv('indeces-jul26-aug9-2012.csv')
del df_price['Date']
df_rets = df_price.shift(-1) / df_price -1
df_rets = df_rets.drop(df_rets.index[-1])
df_rets.to_csv('output.csv', sep=',')

#2
df_norm = df_rets - df_rets.mean()
N = df_norm.shape[0]
mat_norm = np.matrix(df_norm)
mat_cov = np.round(1.0/(N-1) * mat_norm.transpose() * mat_norm,9)
pd.DataFrame(mat_cov,columns=df_rets.columns,index=df_rets.columns).to_csv('output.csv', sep=',')
        \end{lstlisting}
    \end{homeworkSection}
    \begin{homeworkSection}{(iii)}
        Similar to part(i), the daily log returns $X$ is:
\begin{table}[h]
\centering
\begin{tabular}{rrrr}
  & Dow Jones    & NASDAQ       & S\&P 500     \\
0 & 0.014461272  & 0.022163352  & 0.01890085   \\
1 & -0.000202687 & -0.004149784 & -0.000483533 \\
2 & -0.004932973 & -0.002147703 & -0.004326099 \\
3 & -0.002505311 & -0.006590771 & -0.002904193 \\
4 & -0.007522755 & -0.003581491 & -0.007532003 \\
5 & 0.016731061  & 0.019780592  & 0.018861295  \\
6 & 0.001628158  & 0.007388655  & 0.002326568  \\
7 & 0.003887229  & 0.008641743  & 0.005093766  \\
8 & 0.000534462  & -0.001529755 & 0.000620637  \\
9 & -0.000793445 & 0.002451124  & 0.000413544 
\end{tabular}
\end{table}
    \end{homeworkSection}
    \begin{homeworkSection}{(iv)}
        Similar to part(ii), the covariance matrix of the daily log returns is:
\begin{table}[h]
\centering
\begin{tabular}{rrrr}
          & Dow Jones  & NASDAQ      & S\&P 500   \\
Dow Jones & 6.1075e-05 & 7.3212e-05  & 7.0216e-05 \\
NASDAQ    & 7.3212e-05 & 0.000102023 & 8.6587e-05 \\
S\&P 500  & 7.0216e-05 & 8.6587e-05  & 8.1456e-05
\end{tabular}
\end{table}
        \\Python code attached:
        \begin{lstlisting}
#3
df_price = pd.read_csv('indeces-jul26-aug9-2012.csv')
del df_price['Date']
df_rets = np.log(df_price.shift(-1) / df_price)
df_rets = df_rets.drop(df_rets.index[-1])
df_rets.to_csv('output.csv', sep=',')

#4
df_norm = df_rets - df_rets.mean()
N = df_norm.shape[0]
mat_norm = np.matrix(df_norm)
mat_cov = 1.0/(N-1) * mat_norm.transpose() * mat_norm
pd.DataFrame(mat_cov,columns=df_rets.columns,index=df_rets.columns).to_csv('output.csv', sep=',')
        \end{lstlisting}
    \end{homeworkSection}
\end{homeworkProblem}

%----------------------------------------------------------------------------------------
%   PROBLEM 3
%----------------------------------------------------------------------------------------

\begin{homeworkProblem}
    \begin{homeworkSection}{(i)}
        States of the market are:
        \begin{itemize}
            \item Asset at \$30 (state $\omega^1$)
            \item Asset at \$35 (state $\omega^2$)
            \item Asset at \$40 (state $\omega^3$)
            \item Asset at \$42 (state $\omega^4$)
            \item Asset at \$45 (state $\omega^5$)
            \item Asset at \$50 (state $\omega^6$)
        \end{itemize}
        The payoff matrix of this model is:
        \begin{equation}
            M_{1/2} = \left( \begin{array} {c}
            S_{1,1/2} \\
            S_{2,1/2} \\
            S_{3,1/2} \\
            S_{4,1/2} 
            \end{array}
            \right)
            = \left( \begin{array} {cccccc}
            1.03 & 1.03 & 1.03 & 1.03 & 1.03 & 1.03 \\
            30 & 35 & 40 & 42 & 45 & 50 \\
            0 & 0 & 0 & 2 & 5 & 10\\
            10 & 5 & 0 & 0 & 0 & 0
            \end{array}
            \right)
        \end{equation}
    \end{homeworkSection}
    \begin{homeworkSection}{(ii)}
        It is easy to check that
        \begin{equation}
            rank(M_{1/2}) = 3 < S = 6
        \end{equation}
        where $S$ is the number of states, then the market is incomplete. 
    \end{homeworkSection}
    \begin{homeworkSection}{(iii)}
        Since
        \begin{equation}
            S_{2,1/2} + S_{4,1/2} - S_{3,1/2} = \frac{40}{1.03}S_{1,1/2} 
        \end{equation}
        the payoff matrix is not linear independent, therefore the four securities are not non-redundant.
    \end{homeworkSection}
\end{homeworkProblem}

\end{document}